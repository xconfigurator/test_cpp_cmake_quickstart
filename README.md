# 使用CMake控制的项目

## 视频
[参考视频(10分钟) 首选](https://www.bilibili.com/video/BV1rR4y1E7n9?spm_id_from=333.337.search-card.all.click&vd_source=8bd7b24b38e3e12c558d839b352b32f4)  
[参考视频](https://www.bilibili.com/video/BV13K411M78v?p=2&spm_id_from=pageDriver)


## update 20220806  
1. 不需要做的
- 不需要.vscode  
- 如果使用msvc不需要使用Developer Command Prompt for VS 2022打开VSCode工程  
2. 配置ctrl + shift + p 输入 cmake configure
```shell
# 对应配置项目命令：
cmake -S . -B build
``` 
3. 构建ctrl + shift + p 输入 cmake build
```shell
# 对应构建项目命令
cmake --build build
```


## archived before 20220806
测试从X13上提交

## 安装插件
C/C++
CMake
CMake Tools

## 完全配置json 适配VSCode "F5"
- launch.json -- for debug
- tasks.json -- for build before debug
>launch.json
```json
{
    // 使用 IntelliSense 了解相关属性。 
    // 悬停以查看现有属性的描述。
    // 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "g++.exe - 生成和调试活动文件",
            "type": "cppdbg",
            "request": "launch",
            // "program": "${fileDirname}\\${fileBasenameNoExtension}.exe",
            "program": "${workspaceFolder}\\build\\my_cmake_swap.exe", // liuyang modify
            "args": [],
            "stopAtEntry": false,
            "cwd": "C:\\CodeBlocks\\MinGW\\bin",
            "environment": [],
            "externalConsole": false,
            "MIMode": "gdb",
            "miDebuggerPath": "C:\\CodeBlocks\\MinGW\\bin\\gdb.exe",
            "setupCommands": [
                {
                    "description": "为 gdb 启用整齐打印",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                }
            ],
            // 编译：（手动编译）则注释掉"preLaunchTask"
            // "preLaunchTask": "C/C++: g++.exe build active file"  
            // 注1(直接调用g++)：g++ -g ./main.cpp ./swap.cpp -o my_cmake_swap.exe
            // 注2(调用cmake)：cd build; cmake ..; mingw32-make;
            // 编译：（利用VSCode调用）
            "preLaunchTask": "build" // liuyang modify // 配置tasks.json调用cmake"自动编译"
        }
    ]
}
```

>tasks.json
```json
{
    // liyang add "cd build"
    "options": {
        "cwd": "${workspaceFolder}/build"
    },
    "tasks": [
        // //////////////////////////////////////////////////////
        // liuyang add build
        {
            "label": "build", 
            "dependsOn":[
                "cmake",
                "make"
            ]
        },
        // liuyang add cmake
        {
            "label": "cmake",
            "type": "shell",
            "command": "cmake",
            "args": [
                ".."
            ]
        },
        // liuyang add make
        {
            "label": "make",
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "command": "mingw32-make", // on linux is make
            "args": [

            ]
        },
        // //////////////////////////////////////////////////////
        // VSCode自己利用g++编译（VSCode自己生成的）
        {
            "type": "cppbuild",
            "label": "C/C++: g++.exe build active file",
            "command": "C:\\CodeBlocks\\MinGW\\bin\\g++.exe",
            "args": [
                "-g",
                "${file}",
                "-o",
                "${fileDirname}\\${fileBasenameNoExtension}.exe"
            ],
            "options": {
                "cwd": "C:\\CodeBlocks\\MinGW\\bin"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by Debugger."
        }
    ],
    "version": "2.0.0"
}
```
----

# 附GitHub相关
## from GitHub 创建完工程的提示
Quick setup — if you’ve done this kind of thing before
or	
git@github.com:xconfigurator/test_cpp_cmake_quickstart.git
Get started by creating a new file or uploading an existing file. We recommend every repository include a README, LICENSE, and .gitignore.

…or create a new repository on the command line
```
echo "# test_cpp_cmake_quickstart" >> README.md
git init
git add README.md
git commit -m "first commit"
git branch -M main
git remote add origin git@github.com:xconfigurator/test_cpp_cmake_quickstart.git
git push -u origin main
```
…or push an existing repository from the command line
```
git remote add origin git@github.com:xconfigurator/test_cpp_cmake_quickstart.git
git branch -M main
git push -u origin main
```

…or import code from another repository
You can initialize this repository with code from a Subversion, Mercurial, or TFS project.

----

# 附 分步骤演示（在没有配置完整的launch.json和tasks.json时）

## 编译
先要ctrl + shift + p -> "CMake 配置" -> 选择gcc
```
cd build
cmake ..
# make
mingw32-make
```
可执行文件就在build文件夹下

## 调试
配置.vscode/launch.json
>launch.json
```
# 修改
// "program": "${fileDirname}\\${fileBasenameNoExtension}.exe",
"program": "${workspaceFolder}\\build\\my_cmake_swap.exe",
# 注释掉preLaunchTask
// "preLaunchTask": "C/C++: g++.exe build active file"
```